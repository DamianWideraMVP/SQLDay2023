{
	"name": "ADF_UAT",
	"properties": {
		"content": {
			"query": "CREATE DATABASE adf_uat\nGO\nuse adf_uat\nGO\n\nDROP VIEW IF EXISTS dbo.MonitorClean\nGO\nCREATE VIEW dbo.MonitorClean\nAS\n    SELECT\n        *\n    FROM\n        OPENROWSET(\n            BULK 'https://sqlday2023.dfs.core.windows.net/bronze/monitor/part-00000-13861fd6-b11e-42a4-ac3b-163984640fe5-c000.snappy.parquet',\n            FORMAT = 'PARQUET'\n        ) AS [result]\n    WHERE [Run start] NOT IN ('Source=.Net SqlClient Data Provider','Original')\nGO\nDROP VIEW IF EXISTS dbo.Monitor\nGO\nCREATE VIEW dbo.Monitor\nAS\nSELECT \n* , DATEDIFF(ss, [Start time], [End time] ) as [Diff in secs]\nFROM\n(\n    SELECT\n        *,\n        CONVERT(datetime, REPLACE(REPLACE(REPLACE([Run start],',',''),'AM',''),'PM',''),120) as [Start time], \n        CONVERT(datetime, REPLACE(REPLACE(REPLACE([Run end],',',''),'AM',''),'PM',''),120) as [End time] \n    FROM dbo.MonitorClean\n)X\n\ngo\n\nselect  * from dbo.Monitor\nGO\n\n\nSELECT [Pipeline name], \n        COUNT(*) as [Execution count], \n        MIN([Diff in secs]) as [Min diff in secs],\n        MAX([Diff in secs]) as [Max diff in secs],\n        AVG([Diff in secs]) as [Avg diff in secs],\n        CAST(STDEV([Diff in secs]) as INT) as [stdev diff in secs]\nFROM dbo.Monitor\nGROUP BY [Pipeline name]\n\n\nSELECT [Pipeline name], \n        CAST([Start time] as DATE) as [Start time],\n        COUNT(*) as [Execution count], \n        MIN([Diff in secs]) as [Min diff in secs],\n        MAX([Diff in secs]) as [Max diff in secs],\n        AVG([Diff in secs]) as [Avg diff in secs],\n        CAST(STDEV([Diff in secs]) as INT) as [stdev diff in secs]\nFROM dbo.Monitor\nGROUP BY [Pipeline name], [Start time]\n\n\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "adf_uat",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}